

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pulsar data analysis &mdash; GMRT tutorials 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CAPTURE Pipeline" href="capturep.html" />
    <link rel="prev" title="Spectral line data reduction using CASA (source 1543+480)" href="HIabsv0.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            GMRT tutorials
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="beforeyoubegin.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="introtogmrtdata.html">Introduction to the GMRT data</a></li>
<li class="toctree-l1"><a class="reference internal" href="continuumband4.html">Continuum data reduction using CASA</a></li>
<li class="toctree-l1"><a class="reference internal" href="HIabsv0.html">Spectral line  data reduction using CASA (source 1543+480)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pulsar data analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-inspection">Data-inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dedispersion-and-folding">Dedispersion and Folding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#searching-for-new-pulsars">Searching for new pulsars</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-filterbank-file">Checking filterbank file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dedispersion">Dedispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exploring-the-time-series">Exploring the time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="#single-pulse-search">Single pulse search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-for-faint-pulsars-using-periodicity-search">Search for faint pulsars using periodicity search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#folding-filterbank-file">Folding filterbank file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#timing-of-pulsars">Timing of Pulsars</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prediction-of-phases-of-pulsar-using-tempo2">Prediction of phases of pulsar using TEMPO2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-impact-of-parameter-errors-on-timing-data">The impact of parameter errors on timing data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-to-solve-a-newly-discovered-pulsar">Time to solve a Newly Discovered Pulsar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-of-arrival-estimation">Time of arrival estimation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#acknowledgements-and-credits">Acknowledgements and Credits</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="capturep.html">CAPTURE Pipeline</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GMRT tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Pulsar data analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pulsar.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pulsar-data-analysis">
<h1>Pulsar data analysis<a class="headerlink" href="#pulsar-data-analysis" title="Link to this heading"></a></h1>
<p>The tutorial is intended to provide you a basic introduction to the steps involved in
the analysis of pulsar data, including searching for new pulsars/transients and timing
a newly discovered pulsar. The filterbank data obtained from GMRT are
converted to SIGPROC filterbank format using either the <code class="docutils literal notranslate"><span class="pre">filterbank</span></code> command from
SIGPROC or the <code class="docutils literal notranslate"><span class="pre">rficlean</span></code> command from RFIClean. The tutorial will use data already
converted to the SIGPROC filterbank format.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>You need to have PRESTO, SIGPROC, TEMPO2, TEMPO, and their dependencies installed on
your machine. You also need the SIGPROC filterbank data to be available on your disk.</p>
<p>The header information of the data from a SIGPROC filterbank file can be inspected using
the <code class="docutils literal notranslate"><span class="pre">readfile</span></code> command from PRESTO (an example using the <code class="docutils literal notranslate"><span class="pre">header</span></code> command from
SIGPROC will be shown later).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">readfile</span> <span class="n">inputFile</span><span class="o">.</span><span class="n">fil</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/headerintro.png"><img alt="readfile output" src="_images/headerintro.png" style="width: 352.09999999999997px; height: 482.99999999999994px;" /></a>
</figure>
<section id="data-inspection">
<h3>Data-inspection<a class="headerlink" href="#data-inspection" title="Link to this heading"></a></h3>
<p>A section of the raw data can be inspected by plotting the data as a function of time
and frequency, e.g., using the <code class="docutils literal notranslate"><span class="pre">waterfaller.py</span></code> command from PRESTO. The command
<code class="docutils literal notranslate"><span class="pre">waterfaller.py</span></code> several provisions that enable inspecting the data in several ways
(e.g., before and after dedispersion, partial and full averaging over the bandwidth,
partial averaging over time, etc.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">waterfaller</span><span class="o">.</span><span class="n">py</span> <span class="n">inputFile</span><span class="o">.</span><span class="n">fil</span> <span class="o">-</span><span class="n">d</span> <span class="mi">0</span> <span class="o">--</span><span class="n">subdm</span> <span class="mi">0</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">ts</span> <span class="o">-</span><span class="n">s</span> <span class="mi">64</span> <span class="o">-</span><span class="n">T</span> <span class="mi">0</span> <span class="o">-</span><span class="n">t</span> <span class="mi">5</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/wfaller1.png"><img alt="waterfall 0-DM" src="_images/wfaller1.png" style="width: 405.29999999999995px; height: 312.9px;" /></a>
</figure>
<p>The single pulses from a reasonably strong pulsars might be visible after dedispersing
the data at correct dispersion measure (DM).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">waterfaller</span><span class="o">.</span><span class="n">py</span> <span class="n">inputFile</span><span class="o">.</span><span class="n">fil</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">DM</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">subdm</span> <span class="o">&lt;</span><span class="n">DM</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">ts</span> <span class="o">-</span><span class="n">s</span> <span class="mi">64</span> <span class="o">-</span><span class="n">T</span> <span class="mi">0</span> <span class="o">-</span><span class="n">t</span> <span class="mi">5</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/wfaller2.png"><img alt="waterfall correct-DM" src="_images/wfaller2.png" style="width: 405.29999999999995px; height: 312.9px;" /></a>
</figure>
</section>
<section id="dedispersion-and-folding">
<h3>Dedispersion and Folding<a class="headerlink" href="#dedispersion-and-folding" title="Link to this heading"></a></h3>
<p>A small section of the raw data can be dedispersed and viewed using <code class="docutils literal notranslate"><span class="pre">waterfaller.py</span></code>
as seen above. To dedisperse the whole data and also fold it over the rotation period
of the pulsar, we can use <code class="docutils literal notranslate"><span class="pre">prepdata</span></code> from PRESTO.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prepfold</span> <span class="o">-</span><span class="n">p</span> <span class="mf">3.7452943</span> <span class="o">-</span><span class="n">dm</span> <span class="mf">50.9</span> <span class="o">-</span><span class="n">topo</span> <span class="o">-</span><span class="n">n</span> <span class="mi">128</span> <span class="o">-</span><span class="n">nosearch</span>  <span class="n">introTestd4</span><span class="o">.</span><span class="n">fil</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">prepfold</span></code> is a powerful command, it can search for the most optimum parameters around
the given fiducial parameters.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="images/pulsar/prepout.png"><img alt="prepfold output" src="images/pulsar/prepout.png" /></a>
</figure>
</section>
</section>
<section id="searching-for-new-pulsars">
<span id="psrsearchb4"></span><h2>Searching for new pulsars<a class="headerlink" href="#searching-for-new-pulsars" title="Link to this heading"></a></h2>
<p>This part of the tutorial aims to demostrate the process of pulsar search using observations from GMRT. We will use band-4 (550-750 MHz) data of a test pulsar.</p>
<section id="id1">
<h3>Introduction<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Pulsars are fascinating extraterrestrial objects that produce pulse like emission with very precise periodicity. These objects are often detected in time domain radio observations. In this tutorial, we will learn how to search for these objects using the strengths of individual pulsed emission as well as their precise periodic behaviour. This tutorial will require PRESTO installed on your machine along with a filterbank file with pulsar in it.</p>
</section>
<section id="checking-filterbank-file">
<h3>Checking filterbank file<a class="headerlink" href="#checking-filterbank-file" title="Link to this heading"></a></h3>
<p>Filterbank file is a file-format for beam data from radio telescopes. This file has the metadata of the observation along with the raw beamdata recorded in the telescope. Use following syntax to check the metadata,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">header</span> <span class="o">&lt;</span><span class="n">filterbank_file</span><span class="o">.</span><span class="n">fil</span><span class="o">&gt;</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<img alt="_images/header_tutorial.png" src="_images/header_tutorial.png" />
<figcaption>
<p><span class="caption-text"><em>Example of a filterbank header</em></span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="dedispersion">
<h3>Dedispersion<a class="headerlink" href="#dedispersion" title="Link to this heading"></a></h3>
<p>For an unknown pulsar, we don’t know the dispersion caused by the intersteller medium. We try a lot of trial DM values and perform search in each dedispersed time series. We will use <code class="docutils literal notranslate"><span class="pre">prepsubband</span></code> to dedisperse the filterbank file at a range of trial DM values,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prepsubband</span> <span class="o">-</span><span class="n">lodm</span> <span class="o">&lt;</span><span class="n">smallest_trial_dm</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">dmstep</span> <span class="o">&lt;</span><span class="n">seperation_between_dms</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">numdms</span> <span class="o">&lt;</span><span class="n">number_of_trial_dms</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">numout</span> <span class="o">&lt;</span><span class="n">number_of_output_samples</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">input_fil_name</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output_base_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Please note that number of output samples should be an even number (in order to get a straight-forwand FFT in later stage). This will create a number of dedispersed time series with names output_base_name_dm.dat. These are the time series that will be used for single pulse search as well as periodicity search.</p>
</section>
<section id="exploring-the-time-series">
<h3>Exploring the time series<a class="headerlink" href="#exploring-the-time-series" title="Link to this heading"></a></h3>
<p>Now, since we have the dedispersed time series, we can try to visualize the pulses in the time series. Use <code class="docutils literal notranslate"><span class="pre">exploredat</span></code> to visualize the time series,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exploredat</span> <span class="n">output_base_name</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
<p>This will generate an interactive plot,</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="_images/J1534+5334_exploredat.png"><img alt="Importgmrt log" src="_images/J1534%2B5334_exploredat.png" style="width: 554.4px; height: 431.9px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Output plot of exploredat. One can zoom in, zoom out, and move around in this plot.</em></span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>You can even try to estimate the period of the repeating signal from this plot.</p>
</section>
<section id="single-pulse-search">
<h3>Single pulse search<a class="headerlink" href="#single-pulse-search" title="Link to this heading"></a></h3>
<p>Though we have seen the single pulses from the pulsar directly in the time series, there is a formal way to search for single pulses in the time series.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_pulse_search</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">significance_threshold</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">m</span> <span class="o">&lt;</span><span class="n">maximum_width</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dedispersed_time_Series</span><span class="o">.</span><span class="n">dat</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This generates a text file with information of individual detected pulses for each time series. Now, we need to combine the results of each search in a single summary plot,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">single_pulse_search</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">significance_threshold</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">_dedispersed_time_Series</span><span class="o">.</span><span class="n">singlepulse</span><span class="o">&gt;</span>
</pre></div>
</div>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="_images/single_pulse_tutorial.png"><img alt="Listobs log" src="_images/single_pulse_tutorial.png" style="width: 690.1999999999999px; height: 689.5px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Output of single pulse search. We get location of pulses, number of pulses, and single pulse S/Ns as a function of DM.</em></span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>You can note down timestamp of some strong pulses from the text file and try to varify it’s presence in the time series using <code class="docutils literal notranslate"><span class="pre">exploredat</span></code>. The candidate plot of a single pulse is contains various diagonstic plots,</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="_images/single_pulse_cand.png"><img alt="Listobs log" src="_images/single_pulse_cand.png" style="width: 937.8000000000001px; height: 544.6px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Diagnostic plot of a single pulse candidate.</em></span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="_images/single_pulse_noise.png"><img alt="Listobs log" src="_images/single_pulse_noise.png" style="width: 931.0px; height: 547.2px;" /></a>
<figcaption>
<p><span class="caption-text"><em>False single pulse candidate.</em></span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="search-for-faint-pulsars-using-periodicity-search">
<h3>Search for faint pulsars using periodicity search<a class="headerlink" href="#search-for-faint-pulsars-using-periodicity-search" title="Link to this heading"></a></h3>
<p>There are pulsars that are weak and can not be seen in single pulses. To recover such puslars, we use their periodic property to get a good indication of their presence in the time series. Here, we will see one such method called FFT based periodicity search. The process is to take Fourier transform of the time series and search for strong signal in the power spectra.
First we will see how FFT of a time series with repeating signal looks like. To compute the FFT of the time series,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">realfft</span> <span class="o">-</span><span class="n">fwd</span> <span class="o">&lt;</span><span class="n">dedispersed_time_series</span><span class="o">.</span><span class="n">dat</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will create a file with .fft extension. To see this file in a plot,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">explorefft</span> <span class="o">&lt;</span><span class="n">dedispersed_time_series</span><span class="o">.</span><span class="n">fft</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>You will see signal at fundamental and subsequent harmonics.</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="_images/fft_tutorial.png"><img alt="Listobs log" src="_images/fft_tutorial.png" style="width: 559.3px; height: 408.09999999999997px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Visualization of power-spectra of a time series. Strong signal can be seen at the fundamental and subsequent harmoics.</em></span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<dl>
<dt>An algorithm called harmonic summing is used to add up signal power in the harmonics to increase the detection significance. This algorithm is implemented in <code class="docutils literal notranslate"><span class="pre">accelsearch</span></code>.</dt><dd><p>We use <code class="docutils literal notranslate"><span class="pre">accelsearch</span></code> to search for periodic signal, after cleaning the FFT of timeseries using <code class="docutils literal notranslate"><span class="pre">rednoise</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rednoise</span> <span class="o">&lt;</span><span class="n">dedispersed_time_series</span><span class="o">.</span><span class="n">fft</span><span class="o">&gt;</span>
<span class="n">aacelsearch</span> <span class="o">-</span><span class="n">zmax</span> <span class="mi">0</span> <span class="o">-</span><span class="n">numharm</span> <span class="mi">16</span> <span class="o">&lt;</span><span class="n">dedispersed_time_series_red</span><span class="o">.</span><span class="n">fft</span><span class="o">&gt;</span>
</pre></div>
</div>
</dd>
</dl>
<p>This will generate a text file containing the results of the search.</p>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="_images/Accelsearch_result.png"><img alt="Listobs log" src="_images/Accelsearch_result.png" style="width: 988.4px; height: 276.5px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Result of accelsearch. First detection is the first harmonic of the pulsar signal.</em></span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="folding-filterbank-file">
<h3>Folding filterbank file<a class="headerlink" href="#folding-filterbank-file" title="Link to this heading"></a></h3>
<p>Once we know the correct period and DM of the pulsar, we can fold the filterbank file to generate characteristic plots of the pulsar. We use <code class="docutils literal notranslate"><span class="pre">prepfold</span></code> to fold a filterbank,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prepfold</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">period</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">dm</span> <span class="o">&lt;</span><span class="n">DM</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">nosearch</span> <span class="o">-</span><span class="n">zerodm</span> <span class="o">&lt;</span><span class="n">filterbank_file</span><span class="o">.</span><span class="n">fil</span><span class="o">&gt;</span>
</pre></div>
</div>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="_images/tutorial_profile.png"><img alt="Listobs log" src="_images/tutorial_profile.png" style="width: 695.0999999999999px; height: 518.6999999999999px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Result of prepfold. Profile of the pulsar along with subintegration vs phase, frequency vs phase, S/N vs DM, S/N vs period plots.</em></span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="_images/J1533_noise_cand.png"><img alt="Listobs log" src="_images/J1533_noise_cand.png" style="width: 693.0px; height: 521.5px;" /></a>
<figcaption>
<p><span class="caption-text"><em>A false candidate. The pulse seen in the profile is caused by RFI in the time series.</em></span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>There are lot of such plots for each trial DM in a blind search. All these plots are inspected either by eye or an machine learning based classifier to tell which one is a pulsar and which one is not. Once a pulsar is identified, one needs to check if it’s a new pulsar or an already known pulsar.</p>
</section>
</section>
<section id="timing-of-pulsars">
<span id="continuumb4"></span><h2>Timing of Pulsars<a class="headerlink" href="#timing-of-pulsars" title="Link to this heading"></a></h2>
<p>The tutorial is intended to provide you an introduction to the basic steps related to the timing analysis of pulsar using GMRT beam data. We will be using the band-3 (300 - 500 MHz) datasets for this purpose. We will only consider the case of an isolated pulsar for the exercise.</p>
<p>We will use PSRCHIVE and TEMPO2 Softwares.</p>
<section id="id2">
<h3>Introduction<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>The GMRT beam data is in binary format and is converted to “filterbank” format (same binary file with a header). The “filterbank” is folded based on pulsar ephemeris, yielding three-dimensional (time, frequency, phase) folded pulsar data (“pfd”). For this tutorial, we will begin with “pfd” files.</p>
<p>You need to have PSRCHIVE and TEMPO2 installed on your machine. You also need the “pfd” files to be
available on your disk.</p>
</section>
<section id="prediction-of-phases-of-pulsar-using-tempo2">
<h3>Prediction of phases of pulsar using TEMPO2<a class="headerlink" href="#prediction-of-phases-of-pulsar-using-tempo2" title="Link to this heading"></a></h3>
<p>Right Ascension (RA) and Declination (DEC) provide the source’s two-dimensional position in the sky, which is typically defined by the J2000 system. The pulsar’s spin frequency (F0) is defined as the reciprocal of its spining period. F1 is the first derivative of spin frequency with respect to time. Since the pulsar slows down over time, F1 has a negative value. The dispersion measure (DM) quantifies the line of sight column density of electrons. All of these parameters are listed in a file called the pulsar’s parameter file. Let’s start with a parameter file of pulsar J1646-2142, which contains the pulsar’s name, RA, DEC, F0, F1, and DM values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">J1646</span><span class="o">-</span><span class="mf">2142.</span><span class="n">par</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/RAS_IM1.png" src="_images/RAS_IM1.png" />
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tempo2</span> <span class="o">-</span><span class="n">gr</span> <span class="n">fake</span> <span class="o">-</span><span class="n">f</span> <span class="n">J1646</span><span class="o">-</span><span class="mf">2142.</span><span class="n">par</span> <span class="o">-</span><span class="n">nobsd</span> <span class="mi">1</span> <span class="o">-</span><span class="n">ndobs</span> <span class="mi">7</span> <span class="o">-</span><span class="n">randha</span> <span class="n">y</span> <span class="o">-</span><span class="n">ha</span> <span class="mi">8</span> <span class="o">-</span><span class="n">start</span> <span class="mi">59000</span> <span class="o">-</span><span class="n">end</span> <span class="mi">60000</span> <span class="o">-</span><span class="n">rms</span> <span class="mf">1e-3</span>
</pre></div>
</div>
<p>This will generate time of arrivals (ToAs) for this pulsar ranging from MJD 59000 to 60000. ToAs are measured for weekly observations (i.e. one observation per seven days). A single ToA is generated for each observation. Each ToA will have a 1e-3 millisecond error (i.e. 1 microsecond). The observation hour angle is chosen at random over an 8-hour period.</p>
<p>At the end of this a file with name J1646-2142.simulate is created. The file J1646-2142.simulate contains the predicted ToAs of the pulsar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">head</span> <span class="n">J1646</span><span class="o">-</span><span class="mf">2142.</span><span class="n">simulate</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/RAS_IM2.png" src="_images/RAS_IM2.png" />
</figure>
<p>Normally, the first column represents the file name; in this case, it is the same here because it was predicted using tempo2’s fake plugin. The frequency is represented in megahertz in the second column. The third and fourth columns contain the ToAs for the observation and the associated error. Note that we maintained the same error during prediction for all observations. The the last column contains the observatory site code.</p>
</section>
<section id="the-impact-of-parameter-errors-on-timing-data">
<h3>The impact of parameter errors on timing data<a class="headerlink" href="#the-impact-of-parameter-errors-on-timing-data" title="Link to this heading"></a></h3>
<p>First check the phases of the pulsar are derived accurately by running the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tempo2</span> <span class="o">-</span><span class="n">nofit</span> <span class="o">-</span><span class="n">f</span> <span class="n">J1646</span><span class="o">-</span><span class="mf">2142.</span><span class="n">par</span>  <span class="n">J1646</span><span class="o">-</span><span class="mf">2142.</span><span class="n">simulate</span> <span class="o">-</span><span class="n">gr</span> <span class="n">plk</span>
</pre></div>
</div>
<p>The command above displays the difference between the ToAs predicted by the parameter file J1646-2142.par and the ToAs listed in the timing file J1646-2142.simulate. The residuals must be randomly distributed around the zero line if the ToAs listed in the J1646-2142.simulate file matched the prediction from the J1646-2142.par file. The figure below demonstrates this.</p>
<figure class="align-default">
<img alt="_images/RAS_IM3.png" src="_images/RAS_IM3.png" />
</figure>
<p>Now let’s introduce a small error (say around an arc-sec) in postion (RA and DEC) in the parameter file to see the effect of wrong position on the timing data. After putting the offset in the parameter file run the above command again which will show that an error in position has yearly periodic variation in the residuals. This is demonstrated in figure below.</p>
<figure class="align-default">
<img alt="_images/RAS_IM4.png" src="_images/RAS_IM4.png" />
</figure>
<p>If you fit for the RA/DEC for which the error is introduced, you will again get the randomly sampled residuals around the zero line in the post-fit residuals.</p>
<p>Now, reset the parameter file to its default values and try introducing a small error in F0. The residuals for the F0 error show a straight line pattern with no periodicity, as shown below.</p>
<figure class="align-default">
<img alt="_images/RAS_IM5.png" src="_images/RAS_IM5.png" />
</figure>
<p>Again, if you fit for the F0, you will get the randomly sampled residuals around the zero line in the post-fit residuals.</p>
<p>Try the same thing again with error in F1, and this time you’ll notice a parabolic long-term variation like the one in the image below.</p>
<figure class="align-default">
<img alt="_images/RAS_IM6.png" src="_images/RAS_IM6.png" />
</figure>
<p>Understanding the pattern in the residuals caused by parameter error will assist us in solving a newly discovered pulsar. Once accurate (phase-coherent) solutions for a pulsar are obtained, one can establish its clock-like behaviour and predict its phases at any point in time.</p>
</section>
<section id="time-to-solve-a-newly-discovered-pulsar">
<h3>Time to solve a Newly Discovered Pulsar<a class="headerlink" href="#time-to-solve-a-newly-discovered-pulsar" title="Link to this heading"></a></h3>
<p>This time we will start with the real GMRT data set for a newly discovered pulsar J1244-4708 which is discovered in the GMRT High Resolution Southern Sky Survey.</p>
<p>This pulsar was localised through imaging of a single observational epoch which provides us with its RA and DEC which are accurate to a few arc-seconds. The F0 and DM values of the pulsar were estimated using data from an epoch observation in which the pulsar was strongly detected. We used the reciprocal of the period value (in seconds) given in the waterfall plot of that observation to calculate F0. Similarly, from the same plot, we noted the DM and epoch of the observation. Using these values, we created a parameter file for this pulsar (in this case, J1244-4708.par) that contains an initial guess of its parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">J1244</span><span class="o">-</span><span class="mf">4708.</span><span class="n">par</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/RAS_IM10.png" src="_images/RAS_IM10.png" />
</figure>
<p>In this exercise, we will use GMRT’s incoherent array (IA) beam data. This pulsar has been observed 13 times over a baseline of 9 months. The GMRT IA beam data is first converted to “filterbank” format, then dedispersed and folded to “pfd” format. We’ll start with the “pfd” files right away.</p>
</section>
<section id="time-of-arrival-estimation">
<h3>Time of arrival estimation<a class="headerlink" href="#time-of-arrival-estimation" title="Link to this heading"></a></h3>
<p>The “pfd.ps” files contain waterfall plots for all “pfd” files. The first step is to go through all of the profiles and find the cleanest one with the sufficiently bright integrated pulse. We will use that profile as our reference or template profile, assuming it is the true profile of the pulsar. Use the following command to view all the profiles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">evince</span> <span class="o">*</span><span class="n">ps</span>
</pre></div>
</div>
<p>After selecting the template profile, the next step is to estimate how many ToAs should be extracted from each observation. We will derive a single ToA for full observation for weak detections, two ToAs for mildly detectect profiles, and four ToAs for bright detections. This approach will be adequate to find the solution in this specific case. To determine the number of ToAs for individual observations, check all the profiles again using the command above.</p>
<p>Let’s say you’ve selected k ToAs for a particular observation A.pfd and B.pfd is your chosen epoch for the template. Then run the following command to get the ToAs for observation A.pfd.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_TOAs</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="n">k</span> <span class="o">-</span><span class="n">t</span> <span class="n">B</span><span class="o">.</span><span class="n">bestprof</span> <span class="n">A</span><span class="o">.</span><span class="n">pfd</span> <span class="o">&gt;&gt;</span> <span class="n">J1244</span><span class="o">-</span><span class="mf">4708.</span><span class="n">tim</span>
</pre></div>
</div>
<p>This command will find the ToAs for observation A.pfd by cross-correlating it with template B.bestprof. The ToAs will be saved in the J1244-4708.tim timing file.</p>
<p>The value of k varies depending on the detection strength of the pulsar for each observation. So, for each observation, use the same command, but change the file names A.pfd and the corresponding k value while keeping the template same (i.e., B.bestprof). Once all observations’ ToAs have been generated, run the command below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tempo2</span> <span class="o">-</span><span class="n">nofit</span> <span class="o">-</span><span class="n">f</span> <span class="n">J1244</span><span class="o">-</span><span class="mf">4708.</span><span class="n">par</span> <span class="n">J1244</span><span class="o">-</span><span class="mf">4708.</span><span class="n">tim</span> <span class="o">-</span><span class="n">gr</span> <span class="n">plk</span>
</pre></div>
</div>
<p>This command displays the difference (or residuals) between the observed ToAs (in the J1244-4708.tim file) and the predicted ToAs (predicted using J1244-4708.par file). Because the ToAs for a newly discovered pulsar are not phase-connected, we will not see any general systematic pattern in the residuals. This is illustrated in the figure below.</p>
<figure class="align-default">
<img alt="_images/RAS_IM7.png" src="_images/RAS_IM7.png" />
</figure>
<p>Now, take a sample of densely sampled points and start fitting from F0. Once you’ve identified a pattern in the ToAs, try fitting RA and DEC. Finally, you can try fitting F1, but keep in mind that the value of F1 for 9 months of data will be highly unreliable. Once phase coherent solutions are obtained, ToAs will exhibit near-random behaviour around the zero line, as shown in the figure below.</p>
<figure class="align-default">
<img alt="_images/RAS_IM8.png" src="_images/RAS_IM8.png" />
</figure>
<p>Examine the F0, F1, RA, and DEC values. Since RA and DEC are obtained through imaging, the post-fit RA and DEC should be within a few arc-seconds of the initial guess (i.e., pre-fit values). The F1 value after fitting should be negative and small (compared to error in F0). Below are the fitted values for this exercise.</p>
<figure class="align-default">
<img alt="_images/RAS_IM9.png" src="_images/RAS_IM9.png" />
</figure>
<p>Finally, on the graphical interface, select “new par” to create the new parameter file. Now that the pulsar’s phase-coherent solution has been found, you will be able to predict the ToAs in future observations. The prediction accuracy improves as the number of observations and the timing baseline increase.</p>
</section>
</section>
<section id="acknowledgements-and-credits">
<h2>Acknowledgements and Credits<a class="headerlink" href="#acknowledgements-and-credits" title="Link to this heading"></a></h2>
<p>The <strong>Searching for new pulsars</strong> and <strong>Timing of pulsars</strong> sections of
the tutorial were entirely contributed by Shubham Singh and Shyam Sunder,
respectively. The data sets used in these parts were kindly provided by
Dr. Jayanta Roy and Dr. Bhaswati Bhattacharyya. Yogesh Maan is responsible
for the overall pulsar tutorial coordination as well as for making available
the data used in the <strong>Introduction</strong> section.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="HIabsv0.html" class="btn btn-neutral float-left" title="Spectral line data reduction using CASA (source 1543+480)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="capturep.html" class="btn btn-neutral float-right" title="CAPTURE Pipeline" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ruta Kale.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>